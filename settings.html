
<!DOCTYPE html>
<html lang="es"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Configuraci√≥n ‚Äî OSI</title>
<style>
:root{ --bg:#f7f7fb; --fg:#111; --muted:#666; --border:#e4e7ec; --primary:#0d6efd }
*{ box-sizing:border-box } body{ margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; background:var(--bg) }
.container{ max-width:720px; margin:0 auto; padding:16px } .card{ background:#fff; border:1px solid var(--border); border-radius:16px; padding:16px; box-shadow:0 1px 2px rgba(16,24,40,.04) }
button{ padding:12px; border:1px solid var(--border); border-radius:10px; background:#fff; font-weight:600; width:100%; min-height:44px } button.primary{ background:var(--primary); color:#fff; border-color:var(--primary) }
.grid{ display:grid; grid-template-columns:1fr; gap:10px }
</style></head><body>
<div class="container">
  <div class="card">
    <h2 style="margin:0 0 12px 0">Configuraci√≥n</h2>
    <div class="grid">
      <button id="btnInstall">üì• Instalar app</button>
      <button id="btnShareLink">üîó Compartir enlace</button>
      <button id="btnForceRefresh" class="primary">üßπ Forzar actualizaci√≥n (borrar cach√©)</button>
      <a href="index.html?v=9r3"><button>‚Üê Volver</button></a>
    </div>
    <p style="color:#666;font-size:12px;margin-top:10px">Borrar√° cach√© y Service Worker antiguos y recargar√° la app (build 9r3).</p>
  </div>
</div>
<script>
(function(){
  let deferredPrompt=null;
  window.addEventListener('beforeinstallprompt',(e)=>{e.preventDefault(); deferredPrompt=e;});
  document.getElementById('btnInstall').onclick = async () => {
    if(deferredPrompt){ deferredPrompt.prompt(); await deferredPrompt.userChoice; deferredPrompt=null; }
    else alert('Si no ves el cuadro, usa ‚ÄúAgregar a la pantalla de inicio‚Äù.');
  };
  document.getElementById('btnShareLink').onclick = async () => {
    const link = location.origin + location.pathname.replace('settings.html','index.html') + '?v=9r3';
    if(navigator.share){ try{ await navigator.share({title:'OSI', text:'Formulario OSI', url: link}); }catch(_){}} else { await navigator.clipboard.writeText(link); alert('üîó Enlace copiado'); }
  };
  document.getElementById('btnForceRefresh').onclick = async () => {
    try { if ('caches' in window) { const keys = await caches.keys(); await Promise.all(keys.map(k=>caches.delete(k))); }
          if ('serviceWorker' in navigator) { const regs = await navigator.serviceWorker.getRegistrations(); await Promise.all(regs.map(r=>r.unregister())); } }
    catch(_){}
    location.href = 'index.html?v=9r3&updated=' + Date.now();
  };
})();
</script>
</body></html>
